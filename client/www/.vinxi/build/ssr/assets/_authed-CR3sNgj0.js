import{jsx as e,jsxs as r}from"react/jsx-runtime";import{useRouterState as w,Link as c,Outlet as P}from"@tanstack/react-router";import{FaGithub as T}from"react-icons/fa";import*as h from"react";import{X as k,Menu as E,User as _,House as b,ClipboardList as R,List as F,Calendar as D,Drumstick as I,Settings as $,Loader2 as B}from"lucide-react";import{B as C}from"./button-DZIqpug3.js";import{D as j,a as z,b as G,c as N,d as g}from"./dropdown-menu-CXlQBPJa.js";import*as l from"@radix-ui/react-dialog";import{cva as q}from"class-variance-authority";import{c as f}from"./utils-bhneXptQ.js";import{useAuth as O,SignOutButton as L}from"@clerk/tanstack-start";import{CgProfile as U}from"react-icons/cg";import*as u from"@radix-ui/react-tooltip";import{RxExit as Q}from"react-icons/rx";import{k as y}from"./getAllCategories-f73zdoR0.js";import{useQueryClient as H,QueryClient as X,QueryClientProvider as K}from"@tanstack/react-query";import{g as V}from"./getLatestGrocerylistByHouseholdId-edhHmGoA.js";import{g as J}from"./getAllIngredients-6sXcg4a7.js";import{u as W}from"./useGetCurrentLoggedInUser-BaYIIjoZ.js";import{u as Y}from"./useAppData-BtM9UegS.js";import{ReactQueryDevtoolsPanel as Z}from"@tanstack/react-query-devtools";import"@radix-ui/react-slot";import"@radix-ui/react-dropdown-menu";import"clsx";import"tailwind-merge";import"axios";import"zod";import"./getCurrentLoggedInUser-BSklaDhP.js";const ee=l.Root,te=l.Trigger,d=l.Close,ae=l.Portal,S=h.forwardRef(({className:t,...a},s)=>e(l.Overlay,{className:f("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s}));S.displayName=l.Overlay.displayName;const re=q("fixed z-50 gap-4 dark bg-header p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),M=h.forwardRef(({side:t="right",className:a,children:s,...n},i)=>r(ae,{children:[e(S,{}),r(l.Content,{ref:i,className:f(re({side:t}),a),...n,children:[s,r(l.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e(k,{className:"h-4 w-4"}),e("span",{className:"sr-only",children:"Close"})]})]})]}));M.displayName=l.Content.displayName;const se=h.forwardRef(({className:t,...a},s)=>e(l.Title,{ref:s,className:f("text-lg font-semibold text-foreground",t),...a}));se.displayName=l.Title.displayName;const ie=h.forwardRef(({className:t,...a},s)=>e(l.Description,{ref:s,className:f("text-sm text-muted-foreground",t),...a}));ie.displayName=l.Description.displayName;const ne=u.Provider,le=u.Root,oe=u.Trigger,A=h.forwardRef(({className:t,sideOffset:a=4,...s},n)=>e(u.Content,{ref:n,sideOffset:a,className:f("z-50 overflow-hidden rounded-md border px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));A.displayName=u.Content.displayName;const x=[{title:"My Profile",href:"/settings/profile"},{title:"My Household",href:"/settings/household"}],v=[{name:"Shopping Lists",href:"/lists",comingSoon:!1,httpKey:y.latestGrocerylistByUserId,queryFn:async t=>await V(await t).then(a=>a.data)},{name:"Items",href:"/items",comingSoon:!1,httpKey:y.ingredients,queryFn:async t=>await J(await t).then(a=>a.data)},{name:"Meal Plans",href:"/plans",comingSoon:process.env.NEXT_PUBLIC_FLAG_FEATURE_MEALPLANS!=="true"},{name:"Meals",href:"/meals",comingSoon:process.env.NEXT_PUBLIC_FLAG_FEATURE_MEALPLANS!=="true"}];function de({currentUser:t}){const s=w().location.pathname,{getToken:n}=O();return t?e("nav",{className:"w-full z-50 bg-header",children:e("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r("div",{className:"flex items-center justify-between h-16",children:[r("div",{className:"flex items-center",children:[r("div",{className:"flex-shrink-0 flex",children:[e("h1",{className:"text-white text-2xl font-extrabold",children:"M"}),e("h1",{className:"text-white text-2xl font-extrabold",children:"unchies"})]}),e("div",{className:"hidden md:block ml-10",children:e("div",{className:"flex items-baseline space-x-4",children:v.map(i=>e(me,{href:i.href,active:s===i.href,comingSoon:i.comingSoon,httpKey:i.httpKey,queryFn:async()=>{const o=await n({template:"1_HOUR"}).then(p=>p?.toString());return!o||!i.queryFn||s===i.href?null:i.queryFn(o)},children:i.name},i.name))})})]}),e("div",{className:"hidden md:block",children:e("div",{className:"ml-4 flex items-center md:ml-6",children:e(ce,{avatar:t.image,username:`${t.firstName} ${t.lastName}`,email:t.email})})}),e("div",{className:"flex items-center md:hidden",children:r(ee,{children:[e(te,{asChild:!0,children:r(C,{variant:"ghost",size:"icon",className:"text-white ml-2 w-10 h-10",children:[e(E,{className:"min-h-6 min-w-6"}),e("span",{className:"sr-only",children:"Open main menu"})]})}),e(M,{side:"right",className:"w-full sm:max-w-sm text-white bg-header",children:e(he,{avatar:t.image,username:`${t.firstName} ${t.lastName}`,navigation:v,email:t.email})})]})})]})})}):null}function me({href:t,active:a,children:s,comingSoon:n,httpKey:i,queryFn:o}){const p=H();return n?e(ne,{children:r(le,{children:[e(oe,{children:e(c,{href:"#",className:`relative px-3 py-2 rounded-md text-sm font-medium ${a?"bg-gray-700 text-white":n?"text-gray-500 hover:bg-gray-700 hover:text-gray-500":"text-gray-300 hover:bg-gray-800 hover:text-white"}`,children:s})}),e(A,{children:"Coming Soon"})]})}):e(c,{href:t,className:`px-3 py-2 rounded-md text-sm font-medium ${a?"bg-gray-700 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"}`,onMouseEnter:async()=>{!i||!o||await p.prefetchQuery({queryKey:i,queryFn:o})},children:s})}function ce({avatar:t,username:a,email:s}){const i=w().location.pathname,o=W();return r(j,{children:[e(z,{asChild:!0,children:e("div",{className:"h-10 w-10 bg-gradient-to-r from-blue-400 to-primary rounded-full flex justify-center items-center",children:e("img",{className:"h-10 w-10 rounded-full",src:t,alt:`${a}'s avatar`,width:40,height:40})})}),r(G,{align:"end",className:"w-56 p-2",children:[r("div",{className:"flex gap-2 items-center",children:[e("img",{className:"h-10 w-10 rounded-full",src:t,alt:`${a}'s avatar`,width:40,height:40}),r("div",{className:"flex flex-col",children:[e("h3",{className:"text-sm font-medium",children:a}),e("p",{className:"text-sm text-muted-foreground",children:s})]})]}),e(N,{className:"my-2"}),e(g,{asChild:!0,children:r(c,{href:"/settings/profile",className:"flex items-center",onMouseEnter:async()=>{console.log("prefetch"),i!=="/settings/profile"&&await o.prefetch()},children:[e(_,{className:"mr-2 h-4 w-4"}),e("span",{children:"Profile"})]})}),e(g,{asChild:!0,children:r(c,{href:"/settings/household",className:"flex items-center",children:[e(b,{className:"mr-2 h-4 w-4"}),e("span",{children:"Household"})]})}),e(N,{className:"my-2"}),r(g,{className:"w-full h-8",children:[e(Q,{className:"mr-2 h-4 w-4"}),e(L,{})]})]})]})}function he({avatar:t,username:a,navigation:s,email:n}){return r("div",{className:"pt-5 pb-3 space-y-1 bg-header",children:[r("div",{className:"flex items-center px-4 mb-8",children:[e("div",{className:"h-10 w-10 bg-gradient-to-r from-blue-400 to-primary rounded-full flex justify-center items-center",children:e("img",{className:"h-10 w-10 rounded-full",src:t,alt:`${a}'s avatar`,width:40,height:40})}),r("div",{className:"ml-3",children:[e("h3",{className:"text-base font-medium text-gray-800 dark:text-white",children:a}),e("p",{className:"text-sm text-muted-foreground",children:n})]})]}),r("div",{className:"flex flex-col space-y-2",children:[e(m,{href:"/lists",icon:e(R,{className:"h-6 w-6"}),children:e(d,{children:"Lists"})}),e(m,{href:"/items",icon:e(F,{className:"h-6 w-6"}),children:e(d,{children:"Items"})}),e(m,{href:"/plans",icon:e(D,{className:"h-6 w-6"}),comingSoon:process.env.NEXT_PUBLIC_FLAG_FEATURE_MEALPLANS!=="true",children:e(d,{children:"Meal plans"})}),e(m,{href:"/meals",icon:e(I,{className:"h-6 w-6"}),comingSoon:process.env.NEXT_PUBLIC_FLAG_FEATURE_MEALPLANS!=="true",children:e(d,{children:"Meals"})}),e(m,{href:x[0].href,icon:e($,{className:"h-6 w-6"}),children:e(d,{children:"Settings"})}),e(m,{href:x[0].href,icon:e(U,{className:"h-6 w-6 ml-4"}),children:e(d,{children:"Profile"})}),e(m,{href:x[1].href,icon:e(b,{className:"h-6 w-6 ml-4"}),children:e(d,{children:"Household"})}),e("div",{className:"px-4 pt-4",children:e(C,{className:"w-full h-10 mt-2",variant:"destructive",children:e(L,{})})})]})]})}function m({href:t,icon:a,children:s,comingSoon:n}){return e(c,{href:n?"#":t,className:"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 block px-4 py-2 rounded-md text-base",children:r("span",{className:"flex items-center",children:[a,e("span",{className:`ml-3 ${n?"text-muted-foreground":""}`,children:s}),n&&e("span",{className:"ml-3 text-xs text-muted-foreground",children:"(Coming Soon)"})]})})}function fe({children:t,user:a}){return r("div",{className:"min-h-screen flex flex-col relative",children:[e(de,{currentUser:a}),r("main",{className:"",children:[e("div",{className:"absolute top-0 left-0 right-0 h-[300px] bg-header","aria-hidden":"true"}),r("div",{className:"relative z-10 max-w-7xl mx-auto md:px-4 lg:px-8 min-h-full",children:[e("div",{className:"h-20 md:h-20 flex items-center",children:e("div",{children:e("div",{className:"md:hidden flex gap-2 items-center",children:e("div",{className:"w-full flex justify-between px-2 md:px-3 md:mt-3"})})})}),e("div",{className:"bg-background md:bg-white md:rounded-lg md:shadow-lg overflow-hidden mb-80",children:e("div",{className:"px-0 py-0 md:px-4 md:py-5 sm:p-6",children:t})})]})]}),r("div",{className:"absolute w-full flex flex-col justify-center items-center py-3 gap-2 bottom-2",children:[e("a",{href:"https://github.com/bernardmuller/munchies",target:"_blank",rel:"noreferrer",children:e(T,{className:"w-6 h-6"})}),e("p",{className:"text-sm text-gray-400 text-center",children:"© 2024 Munchies. All rights reserved."})]})]})}const ue=new X;function pe(){const{isFetching:t,isAbsent:a,currentUser:s}=Y();return t&&a&&!s?r("div",{className:"w-full h-full flex flex-col items-center justify-center bg-header text-gray-100",children:[e(B,{className:"w-16 h-16 animate-spin"}),e("span",{className:"text-2xl font-bold",children:"Loading..."})]}):e(fe,{user:s,children:e(P,{})})}const Ge=()=>r(K,{client:ue,children:[e(pe,{}),e(Z,{})]});export{Ge as component};
